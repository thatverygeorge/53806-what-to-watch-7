(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{61:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a.n(c),i=a(18),r=a.n(i),s=a(2),l=a(7),o="/",d="/login",j="/mylist",u="/films/:id/:tab(details|reviews)?",m="/films/:id/review",b="/player/:id",f="overview",h="details",O="reviews",_="/films",g="/login",x="/logout",v="/comments",p="/similar",N="/promo",y="/favorite",w="AUTH",k="NO_AUTH",C="films",S="film",F="reviews",D="similar",L="favorite",R="Bad",I="Normal",T="Good",P="Very Good",q="Awesome",A=a(9),E=a(3),B=a(5),M=a.n(B),G=(M.a.shape({id:M.a.number.isRequired,name:M.a.string.isRequired,posterImage:M.a.string.isRequired,previewImage:M.a.string.isRequired,backgroundImage:M.a.string.isRequired,backgroundColor:M.a.string.isRequired,videoLink:M.a.string.isRequired,previewVideoLink:M.a.string.isRequired,description:M.a.string.isRequired,rating:M.a.number.isRequired,scoresCount:M.a.number.isRequired,director:M.a.string.isRequired,starring:M.a.arrayOf(M.a.string).isRequired,runTime:M.a.number.isRequired,genre:M.a.string.isRequired,released:M.a.number.isRequired,isFavorite:M.a.bool.isRequired}),a(0));var H=function(e){var t=Object(c.useRef)(null),a=e.film;return Object(c.useEffect)((function(){var e=setTimeout((function(){t.current.play().catch((function(){}))}),1e3);return function(){return clearTimeout(e)}}),[]),Object(G.jsx)("video",{src:a.previewVideoLink,ref:t,className:"player__video",width:"280",height:"175",poster:a.previewImage,muted:!0})};var W=function(e){var t=Object(l.g)(),a=e.film,c=e.isActive,n=e.onFilmCardHoverChange;return Object(G.jsxs)("article",{style:{cursor:"pointer"},className:"small-film-card catalog__films-card",onClick:function(){return t.push("/films/".concat(a.id))},onMouseEnter:function(){return n(a.id)},onMouseLeave:function(){return n(void 0)},children:[Object(G.jsx)("div",{className:"small-film-card__image",children:c?Object(G.jsx)(H,{film:a}):Object(G.jsx)("img",{src:a.previewImage,alt:a.name,width:"280",height:"175"})}),Object(G.jsx)("h3",{className:"small-film-card__title",children:Object(G.jsx)(E.b,{to:"/films/".concat(a.id),className:"small-film-card__link",children:a.name})})]})};var U=function(e){var t=e.films,a=e.filmsCount,n=Object(c.useState)(void 0),i=Object(A.a)(n,2),r=i[0],s=i[1],l=function(e){s(e)};return Object(G.jsx)("div",{className:"catalog__films-list",children:t.slice(0,a).map((function(e){return Object(G.jsx)(W,{film:e,isActive:r===e.id,onFilmCardHoverChange:l},e.id)}))})};var z=function(e){var t=e.films,a=e.activeGenre,c=e.onGenreChange,n=new Set(t.map((function(e){return e.genre})));return Object(G.jsxs)("ul",{className:"catalog__genres-list",onClick:c,children:[Object(G.jsx)("li",{className:"catalog__genres-item ".concat("All genres"===a?"catalog__genres-item--active":""),children:Object(G.jsx)(E.b,{to:o,className:"catalog__genres-link",children:"All genres"})}),Array.from(n).map((function(e){return Object(G.jsx)("li",{className:"catalog__genres-item ".concat(a===e?"catalog__genres-item--active":""),children:Object(G.jsx)(E.b,{to:o,className:"catalog__genres-link",children:e})},e)}))]})};var V=function(e){var t=e.className,a=void 0===t?"logo__link":t;return Object(G.jsx)("div",{className:"logo",children:Object(G.jsxs)(E.b,{to:o,className:a,children:[Object(G.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(G.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(G.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})})};var J=function(){return Object(G.jsxs)("footer",{className:"page-footer",children:[Object(G.jsx)(V,{className:"logo__link logo__link--light"}),Object(G.jsx)("div",{className:"copyright",children:Object(G.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})};var Y,K=function(e){var t=e.onShowMoreButtonClick;return Object(G.jsx)("button",{className:"catalog__button",type:"button",onClick:t,children:"Show more"})},Q=function(e){var t=Math.floor(e),a=Math.floor(t/60),c=t-60*a,n=Math.floor(a/60);return a%=60,n=n>9?n:"0".concat(n),a=a>9?a:"0".concat(a),c=c>9?c:"0".concat(c),"00"===n?"".concat(a,":").concat(c):"".concat(n,":").concat(a,":").concat(c)},X=function(e){var t=Math.floor(e/60),a=e%60>9?e%60:"0".concat(e%60);return 0===t?"".concat(a,"m"):0===a||"00"===a?"".concat(t,"h"):"".concat(t,"h ").concat(a,"m")},Z=function(e,t){return"All genres"===t?e:e.filter((function(e){return e.genre===t}))},$=a(8),ee="data/changeGenre",te="data/loadFilms",ae="data/loadFilm",ce="data/loadPromoFilm",ne="data/setIsDataLoaded",ie="user/requiredAuthorization",re="user/logout",se="app/redirectToRoute",le="data/loadReviews",oe="data/loadSimilarFilms",de="data/loadFavoriteFilms",je=Object($.b)(ee,(function(e){return{payload:e}})),ue=Object($.b)(te,(function(e){return{payload:e}})),me=Object($.b)(ae,(function(e){return{payload:e}})),be=Object($.b)(ce,(function(e){return{payload:e}})),fe=Object($.b)(oe,(function(e){return{payload:e}})),he=Object($.b)(le,(function(e){return{payload:e}})),Oe=Object($.b)(de,(function(e){return{payload:e}})),_e=Object($.b)(ne,(function(e){return{payload:e}})),ge=Object($.b)(ie,(function(e){return{payload:e}})),xe=Object($.b)(re),ve=Object($.b)(se,(function(e){return{payload:e}})),pe=function(e){var t=Object.assign({},e,{posterImage:e.poster_image,previewImage:e.preview_image,backgroundImage:e.background_image,backgroundColor:e.background_color,videoLink:e.video_link,previewVideoLink:"https://upload.wikimedia.org/wikipedia/commons/transcoded/b/b3/Big_Buck_Bunny_Trailer_400p.ogv/Big_Buck_Bunny_Trailer_400p.ogv.360p.webm",scoresCount:e.scores_count,runTime:e.run_time,isFavorite:e.is_favorite});return delete t.poster_image,delete t.preview_image,delete t.background_image,delete t.background_color,delete t.video_link,delete t.preview_video_link,delete t.scores_count,delete t.run_time,delete t.is_favorite,t},Ne=function(){return function(e,t,a){return a.get(_).then((function(t){var a=t.data;return e(ue(a.map((function(e){return pe(e)}))))})).then((function(){return e((function(e,t,a){return a.get(N).then((function(t){var a=t.data;return e(be(pe(a)))}))}))})).then((function(){return e(_e({key:C,isDataLoaded:!0}))}))}},ye=a(16),we=a(13),ke={authorizationStatus:k},Ce=Object($.c)(ke,(function(e){e.addCase(ge,(function(e,t){e.authorizationStatus=t.payload})).addCase(xe,(function(e){e.authorizationStatus=k}))})),Se={films:{data:[],isDataLoaded:!1},promoFilm:void 0,film:{data:void 0,isDataLoaded:!1},reviews:{data:void 0,isDataLoaded:!1},similar:{data:void 0,isDataLoaded:!1},favorite:{data:void 0,isDataLoaded:!1}},Fe=Object($.c)(Se,(function(e){e.addCase(ue,(function(e,t){e.films.data=t.payload})).addCase(me,(function(e,t){e.film.data=t.payload})).addCase(be,(function(e,t){e.promoFilm=t.payload})).addCase(fe,(function(e,t){e.similar.data=t.payload})).addCase(Oe,(function(e,t){e.favorite.data=t.payload})).addCase(he,(function(e,t){e.reviews.data=t.payload})).addCase(_e,(function(e,t){e[t.payload.key].isDataLoaded=t.payload.isDataLoaded}))})),De=Object($.c)({genre:"All genres"},(function(e){e.addCase(je,(function(e,t){e.genre=t.payload}))})),Le="USER",Re="FILMS",Ie="UTIL",Te=Object(we.c)((Y={},Object(ye.a)(Y,Le,Ce),Object(ye.a)(Y,Re,Fe),Object(ye.a)(Y,Ie,De),Y)),Pe=function(e){return e[Le].authorizationStatus};var qe=function(){var e=Object(s.c)(Pe),t=Object(l.g)(),a=Object(s.b)(),c=localStorage.getItem("avatar");return e===k?Object(G.jsx)("div",{className:"user-block",children:Object(G.jsx)(E.b,{to:d,className:"user-block__link",children:"Sign in"})}):Object(G.jsxs)("ul",{className:"user-block",children:[Object(G.jsx)("li",{className:"user-block__item",children:Object(G.jsx)("div",{className:"user-block__avatar",onClick:function(){return t.push(j)},children:Object(G.jsx)("img",{src:c||"img/avatar.jpg",alt:"User avatar",width:"63",height:"63"})})}),Object(G.jsx)("li",{className:"user-block__item",children:Object(G.jsx)(E.b,{to:o,className:"user-block__link",onClick:function(e){e.preventDefault(),a((function(e,t,a){return a.delete(x).then((function(){return localStorage.removeItem("token")})).then((function(){return e(xe())})).catch((function(){localStorage.removeItem("token"),e(xe())}))}))},children:"Sign out"})})]})};var Ae=function(e){var t=e.id,a=Object(l.g)();return Object(G.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:function(){return a.push("/player/".concat(t))},children:[Object(G.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(G.jsx)("use",{xlinkHref:"#play-s"})}),Object(G.jsx)("span",{children:"Play"})]})};var Ee=function(e){var t=e.film,a=Object(l.g)(),n=Object(c.useState)(t.isFavorite),i=Object(A.a)(n,2),r=i[0],o=i[1],j=Object(s.c)(Pe),u=Object(s.b)();return Object(G.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(e){e.preventDefault(),j!==w?a.push(d):o((function(e){var a=e?0:1;return u(function(e,t){return function(a,c,n){return n.post("".concat(y,"/").concat(e,"/").concat(t))}}(t.id,a)),!e}))},children:[Object(G.jsx)("svg",{viewBox:"0 0 19 20",width:"19",height:"20",children:Object(G.jsx)("use",{xlinkHref:r?"#in-list":"#add"})}),Object(G.jsx)("span",{children:"My list"})]})},Be=function(e){return e[Re].films.data},Me=function(e){return e[Re].film.data},Ge=function(e){return e[Re].promoFilm},He=function(e){return e[Re].similar.data},We=function(e){return e[Re].reviews.data},Ue=function(e){return e[Re].favorite.data},ze=function(e,t){return e[Re][t].isDataLoaded};var Ve=function(){var e=Object(s.c)(Ge);return Object(G.jsxs)("section",{className:"film-card",children:[Object(G.jsx)("div",{className:"film-card__bg",children:Object(G.jsx)("img",{src:e.backgroundImage,alt:e.name})}),Object(G.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(G.jsxs)("header",{className:"page-header film-card__head",children:[Object(G.jsx)(V,{}),Object(G.jsx)(qe,{})]}),Object(G.jsx)("div",{className:"film-card__wrap",children:Object(G.jsxs)("div",{className:"film-card__info",children:[Object(G.jsx)("div",{className:"film-card__poster",children:Object(G.jsx)("img",{src:e.posterImage,alt:"".concat(e.name," poster"),width:"218",height:"327"})}),Object(G.jsxs)("div",{className:"film-card__desc",children:[Object(G.jsx)("h2",{className:"film-card__title",children:e.name}),Object(G.jsxs)("p",{className:"film-card__meta",children:[Object(G.jsx)("span",{className:"film-card__genre",children:e.genre}),Object(G.jsx)("span",{className:"film-card__year",children:e.released})]}),Object(G.jsxs)("div",{className:"film-card__buttons",children:[Object(G.jsx)(Ae,{id:e.id}),Object(G.jsx)(Ee,{film:e})]})]})]})})]})},Je=function(e){return e[Ie].genre};var Ye=function(){return Object(G.jsx)("p",{style:{marginTop:"100px",textAlign:"center",color:"#252525"},children:"Loading ..."})};var Ke=function(){var e=Object(s.c)((function(e){return ze(e,C)})),t=Object(s.c)(Be),a=Object(s.c)(Je),n=Object(c.useState)(8),i=Object(A.a)(n,2),r=i[0],l=i[1],o=Object(s.b)();return Object(c.useEffect)((function(){return e||o(Ne()),function(){e&&o(_e({key:C,isDataLoaded:!1}))}}),[o,e]),Object(c.useEffect)((function(){o(je("All genres"))}),[o]),e?Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(Ve,{}),Object(G.jsxs)("div",{className:"page-content",children:[Object(G.jsxs)("section",{className:"catalog",children:[Object(G.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),Object(G.jsx)(z,{films:t,activeGenre:a,onGenreChange:function(e){"A"===e.target.tagName&&(e.preventDefault(),e.target.textContent!==a&&(l(8),o(je(e.target.textContent))))}}),Object(G.jsx)(U,{films:Z(t,a),filmsCount:r}),Object(G.jsx)("div",{className:"catalog__more",children:!(r>=Z(t,a).length)&&Object(G.jsx)(K,{onShowMoreButtonClick:function(){l((function(e){return e+8}))}})})]}),Object(G.jsx)(J,{})]})]}):Object(G.jsx)(Ye,{})};var Qe=function(){var e=Object(s.c)(Pe),t=Object(c.useState)(!1),a=Object(A.a)(t,2),n=a[0],i=a[1],r=Object(s.b)();return e!==k?Object(G.jsx)(l.a,{to:o}):Object(G.jsxs)("div",{className:"user-page",children:[Object(G.jsxs)("header",{className:"page-header user-page__head",children:[Object(G.jsx)(V,{}),Object(G.jsx)("h1",{className:"page-title user-page__title",children:"Sign in"})]}),Object(G.jsx)("div",{className:"sign-in user-page__content",children:Object(G.jsxs)("form",{action:"#",className:"sign-in__form",onInput:function(){i(!1)},onSubmit:function(e){e.preventDefault();var t=new FormData(e.target),a=t.get("user-email"),c=t.get("user-password");c.split("").some((function(e){return" "!==e}))?r(function(e){var t=e.email,a=e.password;return function(e,c,n){return n.post(g,{email:t,password:a}).then((function(e){var t=e.data;localStorage.setItem("token",t.token),localStorage.setItem("avatar",t.avatar_url),localStorage.setItem("name",t.name),localStorage.setItem("email",t.email)})).then((function(){return e(ge(w))})).then((function(){return e(ve(o))}))}}({email:a,password:c})).catch((function(){return i(!0)})):i(!0)},children:[n?Object(G.jsx)("div",{className:"sign-in__message",children:Object(G.jsx)("p",{children:"An error occurred. Please check your email or password and try again."})}):"",Object(G.jsxs)("div",{className:"sign-in__fields",children:[Object(G.jsxs)("div",{className:"sign-in__field",children:[Object(G.jsx)("input",{className:"sign-in__input",type:"email",placeholder:"Email address",name:"user-email",id:"user-email",required:!0,"data-testid":"user-email"}),Object(G.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email",children:"Email address"})]}),Object(G.jsxs)("div",{className:"sign-in__field",children:[Object(G.jsx)("input",{className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password",required:!0,"data-testid":"user-password"}),Object(G.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password",children:"Password"})]})]}),Object(G.jsx)("div",{className:"sign-in__submit",children:Object(G.jsx)("button",{className:"sign-in__btn",type:"submit",children:"Sign in"})})]})}),Object(G.jsx)(J,{})]})};var Xe=function(){var e=Object(s.c)(Ue),t=Object(s.c)((function(e){return ze(e,L)})),a=Object(s.b)();return Object(c.useEffect)((function(){return t||a((function(e,t,a){return a.get(y).then((function(t){var a=t.data;return e(Oe(a.map((function(e){return pe(e)}))))})).then((function(){return e(_e({key:L,isDataLoaded:!0}))})).catch((function(){return e(_e({key:L,isDataLoaded:!0}))}))})),function(){t&&a(_e({key:L,isDataLoaded:!1}))}}),[a,t]),t?Object(G.jsxs)("div",{className:"user-page",children:[Object(G.jsxs)("header",{className:"page-header user-page__head",children:[Object(G.jsx)(V,{}),Object(G.jsx)("h1",{className:"page-title user-page__title",children:"My list"}),Object(G.jsx)(qe,{})]}),Object(G.jsxs)("section",{className:"catalog",children:[e&&0!==e.length?Object(G.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}):Object(G.jsx)("h2",{className:"catalog__title",children:"Catalog is empty"}),e&&0!==e.length?Object(G.jsx)(U,{films:e,filmsCount:e.length}):""]}),Object(G.jsx)(J,{})]}):Object(G.jsx)(Ye,{})};var Ze=function(e){var t=e.filmIDToExclude,a=Object(s.c)(He),n=Object(s.c)((function(e){return ze(e,D)})),i=Object(c.useState)(void 0),r=Object(A.a)(i,2),l=r[0],o=r[1],d=Object(s.b)();if(Object(c.useEffect)((function(){var e;return n||d((e=t,function(t,a,c){return c.get("".concat(_,"/").concat(e).concat(p)).then((function(e){var a=e.data;return t(fe(a.map((function(e){return pe(e)}))))})).then((function(){return t(_e({key:D,isDataLoaded:!0}))})).catch((function(){return t(_e({key:D,isDataLoaded:!0}))}))})),function(){n&&d(_e({key:D,isDataLoaded:!1}))}}),[d,t,n]),!n)return Object(G.jsx)(Ye,{});var j,u,m=function(e){o(e)};return Object(G.jsxs)("section",{className:"catalog catalog--like-this",children:[Object(G.jsx)("h2",{className:"catalog__title",children:a&&a.length-1!==0?"More like this":"More like this list is empty"}),a&&a.length-1!==0?Object(G.jsx)("div",{className:"catalog__films-list",children:(j=a,u=t,j.filter((function(e){return e.id!==u}))).slice(0,4).map((function(e){return Object(G.jsx)(W,{film:e,isActive:l===e.id,onFilmCardHoverChange:m},e.id)}))}):""]})};var $e=function(e){var t,a=e.film;return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("div",{className:"film-rating",children:[Object(G.jsx)("div",{className:"film-rating__score",children:a.rating.toString().replace(".",",")}),Object(G.jsxs)("p",{className:"film-rating__meta",children:[Object(G.jsx)("span",{className:"film-rating__level",children:(t=a.rating,t<3?R:t<5?I:t<8?T:t<10?P:t>=10?q:void 0)}),Object(G.jsxs)("span",{className:"film-rating__count",children:[a.scoresCount," ratings"]})]})]}),Object(G.jsxs)("div",{className:"film-card__text",children:[Object(G.jsx)("p",{children:a.description}),Object(G.jsx)("p",{className:"film-card__director",children:Object(G.jsxs)("strong",{children:["Director: ",a.director]})}),Object(G.jsx)("p",{className:"film-card__starring",children:Object(G.jsxs)("strong",{children:["Starring: ",a.starring.join(", ")]})})]})]})};var et=function(e){var t,a=e.film;return Object(G.jsxs)("div",{className:"film-card__text film-card__row",children:[Object(G.jsxs)("div",{className:"film-card__text-col",children:[Object(G.jsxs)("p",{className:"film-card__details-item",children:[Object(G.jsx)("strong",{className:"film-card__details-name",children:"Director"}),Object(G.jsx)("span",{className:"film-card__details-value",children:a.director})]}),Object(G.jsxs)("p",{className:"film-card__details-item",children:[Object(G.jsx)("strong",{className:"film-card__details-name",children:"Starring"}),Object(G.jsx)("span",{className:"film-card__details-value",children:(t=a.starring,t.map((function(e,t,a){return t<a.length-1?Object(G.jsxs)(n.a.Fragment,{children:["".concat(e,", "),Object(G.jsx)("br",{})]},e):Object(G.jsx)(n.a.Fragment,{children:e},e)})))})]})]}),Object(G.jsxs)("div",{className:"film-card__text-col",children:[Object(G.jsxs)("p",{className:"film-card__details-item",children:[Object(G.jsx)("strong",{className:"film-card__details-name",children:"Run Time"}),Object(G.jsx)("span",{className:"film-card__details-value",children:X(a.runTime)})]}),Object(G.jsxs)("p",{className:"film-card__details-item",children:[Object(G.jsx)("strong",{className:"film-card__details-name",children:"Genre"}),Object(G.jsx)("span",{className:"film-card__details-value",children:a.genre})]}),Object(G.jsxs)("p",{className:"film-card__details-item",children:[Object(G.jsx)("strong",{className:"film-card__details-name",children:"Released"}),Object(G.jsx)("span",{className:"film-card__details-value",children:a.released})]})]})]})};var tt=function(e){var t=e.review,a=new Date(t.date);return Object(G.jsxs)("div",{className:"review",children:[Object(G.jsxs)("blockquote",{className:"review__quote",children:[Object(G.jsx)("p",{className:"review__text",children:t.comment}),Object(G.jsxs)("footer",{className:"review__details",children:[Object(G.jsx)("cite",{className:"review__author",children:t.user.name}),Object(G.jsx)("time",{className:"review__date",dateTime:"".concat(a.getFullYear(),"-").concat(a.getMonth()+1,"-").concat(a.getDate()),children:a.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),Object(G.jsx)("div",{className:"review__rating",children:t.rating.toString().replace(".",",")})]})};var at=function(){var e=Object(s.c)(Me),t=Object(s.c)(We),a=Object(s.c)((function(e){return ze(e,F)})),n=Object(s.b)();if(Object(c.useEffect)((function(){var t;return a||n((t=e.id,function(e,a,c){return c.get("".concat(v,"/").concat(t)).then((function(t){return e(he(t.data))})).then((function(){return e(_e({key:F,isDataLoaded:!0}))})).catch((function(){return e(_e({key:F,isDataLoaded:!0}))}))})),function(){a&&n(_e({key:F,isDataLoaded:!1}))}}),[n,e.id,a]),!a)return Object(G.jsx)(Ye,{});if(!t||0===t.length)return Object(G.jsx)("p",{style:{marginTop:"100px",textAlign:"center",color:"#252525"},children:"Reviews list is empty"});var i=t.slice(0,t.length/2+t.length%2),r=t.slice(t.length/2+t.length%2);return Object(G.jsxs)("div",{className:"film-card__reviews film-card__row",children:[Object(G.jsx)("div",{className:"film-card__reviews-col",children:i.map((function(e){return Object(G.jsx)(tt,{review:e},e.id)}))}),Object(G.jsx)("div",{className:"film-card__reviews-col",children:r.map((function(e){return Object(G.jsx)(tt,{review:e},e.id)}))})]})};var ct=function(e){var t=e.film,a=Object(l.h)().tab,c=void 0===a?f:a;return Object(G.jsxs)("div",{className:"film-card__desc",children:[Object(G.jsx)("nav",{className:"film-nav film-card__nav",children:Object(G.jsxs)("ul",{className:"film-nav__list",children:[Object(G.jsx)("li",{className:"film-nav__item ".concat(c===f?"film-nav__item--active":""),children:Object(G.jsx)(E.b,{to:"/films/".concat(t.id),className:"film-nav__link",children:"Overview"})}),Object(G.jsx)("li",{className:"film-nav__item ".concat(c===h?"film-nav__item--active":""),children:Object(G.jsx)(E.b,{to:"/films/".concat(t.id,"/details"),className:"film-nav__link",children:"Details"})}),Object(G.jsx)("li",{className:"film-nav__item ".concat(c===O?"film-nav__item--active":""),children:Object(G.jsx)(E.b,{to:"/films/".concat(t.id,"/reviews"),className:"film-nav__link",children:"Reviews"})})]})}),function(){switch(c){case h:return Object(G.jsx)(et,{film:t});case O:return Object(G.jsx)(at,{film:t});default:return Object(G.jsx)($e,{film:t})}}()]})};var nt=function(e){var t=e.film,a=Object(s.c)(Pe);return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("section",{className:"film-card film-card--full",children:[Object(G.jsxs)("div",{className:"film-card__hero",children:[Object(G.jsx)("div",{className:"film-card__bg",children:Object(G.jsx)("img",{src:t.backgroundImage,alt:t.name})}),Object(G.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(G.jsxs)("header",{className:"page-header film-card__head",children:[Object(G.jsx)(V,{}),Object(G.jsx)(qe,{})]}),Object(G.jsx)("div",{className:"film-card__wrap",children:Object(G.jsxs)("div",{className:"film-card__desc",children:[Object(G.jsx)("h2",{className:"film-card__title",children:t.name}),Object(G.jsxs)("p",{className:"film-card__meta",children:[Object(G.jsx)("span",{className:"film-card__genre",children:t.genre}),Object(G.jsx)("span",{className:"film-card__year",children:t.released})]}),Object(G.jsxs)("div",{className:"film-card__buttons",children:[Object(G.jsx)(Ae,{id:t.id}),Object(G.jsx)(Ee,{film:t}),a===w?Object(G.jsx)(E.b,{to:"/films/".concat(t.id,"/review"),className:"btn film-card__button",children:"Add review"}):""]})]})})]}),Object(G.jsx)("div",{className:"film-card__wrap film-card__translate-top",children:Object(G.jsxs)("div",{className:"film-card__info",children:[Object(G.jsx)("div",{className:"film-card__poster film-card__poster--big",children:Object(G.jsx)("img",{src:t.posterImage,alt:"".concat(t.name," poster"),width:"218",height:"327"})}),Object(G.jsx)(ct,{film:t})]})})]}),Object(G.jsxs)("div",{className:"page-content",children:[Object(G.jsx)(Ze,{filmIDToExclude:t.id}),Object(G.jsx)(J,{})]})]})},it=a(6);var rt=function(e){var t=e.text;return Object(G.jsx)("div",{className:"toast",children:Object(G.jsx)("p",{className:"toast__text",children:t})})};var st=function(e){var t=e.id,a=Object(c.useState)({rating:0,comment:""}),n=Object(A.a)(a,2),i=n[0],r=n[1],l=i.rating,o=i.comment,d=Object(c.useState)(!1),j=Object(A.a)(d,2),u=j[0],m=j[1],b=Object(s.b)(),f=function(e,t){Array.from(e.elements).forEach((function(e){return e.disabled=t}))},h=function(e){m(e,!0),setTimeout((function(){e&&(f(e,!1),m(e,!1))}),2e3)},O=function(e){e&&(f(e,!1),e.reset(),r((function(e){return Object(it.a)(Object(it.a)({},e),{},{rating:0,comment:""})})))};return Object(G.jsxs)("form",{action:"#",className:"add-review__form",onSubmit:function(e){e.preventDefault(),f(e.target,!0),b(function(e,t){var a=t.rating,c=t.comment;return function(t,n,i){return i.post("".concat(v,"/").concat(e),{rating:a,comment:c})}}(t,{rating:l,comment:o})).then((function(){O(e.target),b(ve("/films/".concat(t)))})).catch((function(){return h(e.target)}))},children:[Object(G.jsx)("div",{className:"rating",children:Object(G.jsxs)("div",{className:"rating__stars",onChange:function(e){var t=e.target.value;r((function(e){return Object(it.a)(Object(it.a)({},e),{},{rating:t})}))},children:[Object(G.jsx)("input",{className:"rating__input",id:"star-10",type:"radio",name:"rating",value:"10","data-testid":"star-10"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-10",children:"Rating 10"}),Object(G.jsx)("input",{className:"rating__input",id:"star-9",type:"radio",name:"rating",value:"9"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-9",children:"Rating 9"}),Object(G.jsx)("input",{className:"rating__input",id:"star-8",type:"radio",name:"rating",value:"8"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-8",children:"Rating 8"}),Object(G.jsx)("input",{className:"rating__input",id:"star-7",type:"radio",name:"rating",value:"7"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-7",children:"Rating 7"}),Object(G.jsx)("input",{className:"rating__input",id:"star-6",type:"radio",name:"rating",value:"6"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-6",children:"Rating 6"}),Object(G.jsx)("input",{className:"rating__input",id:"star-5",type:"radio",name:"rating",value:"5"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-5",children:"Rating 5"}),Object(G.jsx)("input",{className:"rating__input",id:"star-4",type:"radio",name:"rating",value:"4"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-4",children:"Rating 4"}),Object(G.jsx)("input",{className:"rating__input",id:"star-3",type:"radio",name:"rating",value:"3"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-3",children:"Rating 3"}),Object(G.jsx)("input",{className:"rating__input",id:"star-2",type:"radio",name:"rating",value:"2"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-2",children:"Rating 2"}),Object(G.jsx)("input",{className:"rating__input",id:"star-1",type:"radio",name:"rating",value:"1"}),Object(G.jsx)("label",{className:"rating__label",htmlFor:"star-1",children:"Rating 1"})]})}),Object(G.jsxs)("div",{className:"add-review__text",children:[Object(G.jsx)("textarea",{className:"add-review__textarea",name:"review-text",id:"review-text",placeholder:"Review text",onChange:function(e){var t=e.target.value;r((function(e){return Object(it.a)(Object(it.a)({},e),{},{comment:t})}))},"data-testid":"review-text"}),Object(G.jsx)("div",{className:"add-review__submit",children:Object(G.jsx)("button",{className:"add-review__btn",type:"submit",disabled:!(0!==l&&o.length>=50&&o.length<=400),children:"Post"})})]}),u?Object(G.jsx)(rt,{text:"An error occurred. Please try again."}):""]})};var lt=function(e){var t=e.film;return Object(G.jsxs)("section",{className:"film-card film-card--full",children:[Object(G.jsxs)("div",{className:"film-card__header",children:[Object(G.jsx)("div",{className:"film-card__bg",children:Object(G.jsx)("img",{src:t.backgroundImage,alt:t.name})}),Object(G.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(G.jsxs)("header",{className:"page-header",children:[Object(G.jsx)(V,{}),Object(G.jsx)("nav",{className:"breadcrumbs",children:Object(G.jsxs)("ul",{className:"breadcrumbs__list",children:[Object(G.jsx)("li",{className:"breadcrumbs__item",children:Object(G.jsx)(E.b,{to:"/films/".concat(t.id),className:"breadcrumbs__link",children:t.name})}),Object(G.jsx)("li",{className:"breadcrumbs__item",children:Object(G.jsx)(E.b,{to:"/films/".concat(t.id,"/review"),className:"breadcrumbs__link",children:"Add review"})})]})}),Object(G.jsx)(qe,{})]}),Object(G.jsx)("div",{className:"film-card__poster film-card__poster--small",children:Object(G.jsx)("img",{src:t.posterImage,alt:"".concat(t.name," poster"),width:"218",height:"327"})})]}),Object(G.jsx)("div",{className:"add-review",children:Object(G.jsx)(st,{id:t.id})})]})};var ot=function(e){var t=e.name,a=e.isPlaying,c=e.duration,n=e.currentTimeInPercentages,i=e.onPausePlayButtonClick,r=e.onFullScreenButtonClick;return Object(G.jsxs)("div",{className:"player__controls",children:[Object(G.jsxs)("div",{className:"player__controls-row",children:[Object(G.jsxs)("div",{className:"player__time",children:[Object(G.jsx)("progress",{className:"player__progress",value:"0",max:"100"}),Object(G.jsx)("div",{className:"player__toggler",style:{left:"".concat(n)},children:"Toggler"})]}),Object(G.jsx)("div",{className:"player__time-value",children:c})]}),Object(G.jsxs)("div",{className:"player__controls-row",children:[Object(G.jsxs)("button",{type:"button",className:"player__play",onClick:i,children:[Object(G.jsx)("svg",{viewBox:"0 0 19 19",width:"19",height:"19",children:Object(G.jsx)("use",{xlinkHref:a?"#pause":"#play-s"})}),Object(G.jsx)("span",{children:"Play"})]}),Object(G.jsx)("div",{className:"player__name",children:t}),Object(G.jsxs)("button",{type:"button",className:"player__full-screen",onClick:r,children:[Object(G.jsx)("svg",{viewBox:"0 0 27 27",width:"27",height:"27",children:Object(G.jsx)("use",{xlinkHref:"#full-screen"})}),Object(G.jsx)("span",{children:"Full screen"})]})]})]})},dt=0,jt=1,ut=-1;var mt=function(e){var t=e.film,a=Object(l.g)(),n=Object(c.useState)({isPlaying:dt,isFullScreen:!1,duration:"",currentTimeInPercentages:""}),i=Object(A.a)(n,2),r=i[0],s=i[1],d=r.isPlaying,j=r.isFullScreen,u=r.duration,m=r.currentTimeInPercentages,b=Object(c.useRef)(),f=function e(t){"Escape"===t.key&&(s((function(e){return Object(it.a)(Object(it.a)({},e),{},{isFullScreen:!e.isFullScreen})})),document.removeEventListener("keydown",e))};return Object(G.jsxs)("div",{className:"player",children:[Object(G.jsx)("video",{ref:b,src:t.videoLink,className:"player__video",poster:t.backgroundImage,onTimeUpdate:function(){s((function(e){return Object(it.a)(Object(it.a)({},e),{},{currentTimeInPercentages:"".concat(100*b.current.currentTime/b.current.duration,"%")})}))},onDurationChange:function(e){s((function(t){return Object(it.a)(Object(it.a)({},t),{},{duration:Q(e.target.duration)})}))}}),Object(G.jsx)("button",{type:"button",className:"player__exit",onClick:function(){return a.push(o)},children:"Exit"}),j?"":Object(G.jsx)(ot,{name:t.name,isPlaying:d,duration:u,currentTimeInPercentages:m,onPausePlayButtonClick:function(){if(d===dt)return s((function(e){return Object(it.a)(Object(it.a)({},e),{},{isPlaying:ut})})),void b.current.play().then((function(){s((function(e){if(e.isPlaying===ut)return Object(it.a)(Object(it.a)({},e),{},{isPlaying:jt})}))})).catch((function(){s((function(e){return Object(it.a)(Object(it.a)({},e),{},{isPlaying:dt})}))}));b.current.pause(),s((function(e){return Object(it.a)(Object(it.a)({},e),{},{isPlaying:dt})}))},onFullScreenButtonClick:function(){s((function(e){return Object(it.a)(Object(it.a)({},e),{},{isFullScreen:!e.isFullScreen})})),document.addEventListener("keydown",f)}})]})};var bt=function(){return Object(G.jsxs)("section",{style:{marginTop:"100px",textAlign:"center",color:"#252525"},children:[Object(G.jsx)("h1",{children:"404. Page not found"}),Object(G.jsx)(E.b,{to:o,children:"Go to the main page"})]})};var ft=function(e){var t=Object(s.c)(Pe),a=e.render,c=e.path,n=e.exact;return Object(G.jsx)(l.b,{path:c,exact:n,render:function(e){return t===w?a(e):Object(G.jsx)(l.a,{to:d})}})},ht=function(e){return function(t){var a=Object(s.c)(Me),n=Object(s.c)((function(e){return ze(e,S)})),i=Object(l.h)().id,r=Object(s.b)();return Object(c.useEffect)((function(){return n||r(function(e){return function(t,a,c){return c.get("".concat(_,"/").concat(e)).then((function(e){var a=e.data;return t(me(pe(a)))})).then((function(){return t(_e({key:S,isDataLoaded:!0}))})).catch((function(){return t(_e({key:S,isDataLoaded:!0}))}))}}(i)),function(){n&&r(_e({key:S,isDataLoaded:!1}))}}),[r,i,n]),n?a?Object(G.jsx)(e,{film:a}):Object(G.jsx)(bt,{}):Object(G.jsx)(Ye,{})}},Ot=ht(nt),_t=ht(lt),gt=ht(mt);var xt=function(){return Object(G.jsxs)(l.d,{children:[Object(G.jsx)(l.b,{exact:!0,path:o,children:Object(G.jsx)(Ke,{})}),Object(G.jsx)(l.b,{exact:!0,path:d,children:Object(G.jsx)(Qe,{})}),Object(G.jsx)(ft,{exact:!0,path:j,render:function(){return Object(G.jsx)(Xe,{})}}),Object(G.jsx)(ft,{exact:!0,path:m,render:function(){return Object(G.jsx)(_t,{})}}),Object(G.jsx)(l.b,{exact:!0,path:u,children:Object(G.jsx)(Ot,{})}),Object(G.jsx)(l.b,{exact:!0,path:b,children:Object(G.jsx)(gt,{})}),Object(G.jsx)(l.b,{children:Object(G.jsx)(bt,{})})]})},vt=a(32),pt=a.n(vt),Nt=401,yt=a(11),wt=Object(yt.a)(),kt=function(e){return function(e){return function(t){return t.type===se&&wt.push(t.payload),e(t)}}},Ct=function(e){var t=pt.a.create({baseURL:"https://7.react.pages.academy/wtw",timeout:5e3});return t.interceptors.response.use((function(e){return e}),(function(t){throw t.response.status===Nt&&e(),t})),t.interceptors.request.use((function(e){return e.headers["x-token"]=function(){var e;return null!==(e=localStorage.getItem("token"))&&void 0!==e?e:""}(),e})),t}((function(){return St.dispatch(ge(k))})),St=Object($.a)({reducer:Te,middleware:function(e){return e({thunk:{extraArgument:Ct}}).concat(kt)}});St.dispatch((function(e,t,a){return a.get(g).then((function(){return e(ge(w))})).catch((function(){}))})),r.a.render(Object(G.jsx)(n.a.StrictMode,{children:Object(G.jsx)(s.a,{store:St,children:Object(G.jsx)(E.a,{history:wt,children:Object(G.jsx)(xt,{})})})}),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.5bcab46f.chunk.js.map